----Commands---


create table ANS_orders(
    order_id integer,
    order_name varchar(20),
    cus_id integer,
    cus_name varchar(50));
    
INSERT INTO ANS_orders VALUES
(1,'Keyboard','22','John'),
(2, 'Mouse', '13','Tom'),
(3, 'Monitor','23','Jenny'),
(4, 'Mousepad', '17','Peter'),
(5, 'Printer', '16','Ritha'),
(6, 'Mouse', '26','Nithu');

ALTER TABLE ANS_orders ADD customer_id int;

UPDATE ANS_orders SET customer_id=10;

UPDATE ANS_orders SET customer_id=20 WHERE ORDER_ID=3;

ALTER TABLE ANS_orders DROP COLUMN customer_id

DELETE FROM ANS_orders WHERE ORDER_ID=1;

DELETE from ANS_orders ;
    
SELECT * FROM ANS_orders 

DROP TABLE ANS_orders ;

EXEC SP_RENAME 'ANS_orders.order_id', 'neworder_id','COLUMN';


---09-09-2022--


--10-09-2022--

SELECT EMPLOYEE_ID  FROM S_HREMPLOYEES sh WHERE DEPARTMENT_ID IN (10,20)

select CONCAT('anu',NULL) from ANS_STUDENT as2 ---anu----

select CONCAT(50,0001) from ANS_STUDENT as2 


SELECT salary + NULL 
FROM S_HREMPLOYEES sh 
WHERE EMPLOYEE_ID  = 105 -----NULL ---


SELECT (100-25)/15*(20-3) from ANS_STUDENT as2  --85---

SELECT SUBSTRING('NEHA SINGH',CHARINDEX(' ', 'NEHA SINGH') , LEN('NEHA SINGH')) FROM S_HREMPLOYEES sh 


SELECT CASE WHEN DEPARTMENT_ID =20 THEN 'IT'
WHEN DEPARTMENT_ID =10 THEN 'HR '
WHEN DEPARTMENT_ID =30 AND SALARY >10000 AND FIRST_NAME <>'DAVID' THEN 'FINANCE'
ELSE 'OTHERS'
END AS DEPARTMENT_NAME, FIRST_NAME, DEPARTMENT_ID  FROM S_HREMPLOYEES sh ;

SELECT CONCAT(SUBSTRING('WGH7878AAA',1,3),SUBSTRING('WGH7878AAA',8,10)) FROM S_HREMPLOYEES sh 


SELECT DISTINCT DEPARTMENT_ID, EMPLOYEE_ID FROM S_HREMPLOYEES sh 

--12-09-2022----

create table ANS_DEMO
(
id integer,
name varchar(20));

insert into ANS_DEMO values(1,'john'),
(1,'john'),(1,'john'),(1,'john'),(1,'john'),
(2,'rita'),(2,'rita'),(2,'rita')

delete from ANS_DEMO where id notselect distinct id,name  from ANS_DEMO

select name,count(1) from ANS_DEMO group by name

SELECT * FROM ANS_STUDENT WHERE STUDENT_NAME LIKE '%r'


SELECT * FROM (
SELECT DENSE_RANK () OVER (PARTITION  BY name ORDER BY id DESC) AS DRNK,id,name
FROM ANS_DEMO 
--WHERE DEPARTMENT_ID=90
)X


select * from ANS_DEMO ad
--13-09-2022



WITH DEL_REC AS
(
SELECT *, ROW_NUMBER() OVER(PARTITION BY id ORDER BY id) as xy
from ANS_DEMO

)
delete from DEL_REC where xy>1


CREATE TABLE ANS_CUS
(
cus_id integer,
name varchar(50));

SELECT * FROM  ANS_CUS
--14-09-2022---

CREATE TABLE dlithe.dbo.S_HREMPLOYEES_ANS(
	EMPLOYEE_ID float NULL,
	FIRST_NAME varchar(20) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	LAST_NAME varchar(25) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	EMAIL varchar(25) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	PHONE_NUMBER varchar(20) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	HIRE_DATE datetime NULL,
	JOB_ID varchar(10) COLLATE SQL_Latin1_General_CP1_CI_AS NULL,
	SALARY decimal(8,2) NULL,
	COMMISSION_PCT decimal(2,2) NULL,
	MANAGER_ID float NULL,
	DEPARTMENT_ID float NULL
);


SELECT * FROM S_HREMPLOYEES_ANS sha 


CREATE TABLE ANS_STUD_DETAILS(
STUDENT_ID INTEGER,
NAME VARCHAR(20),
ADVISOR_ID INTEGER,
STUDENT_AGE INTEGER);



SELECT * FROM ANS_STUD_DETAILS


create table ANS_orders(
    order_id integer,
    order_name varchar(20),
    cus_id integer,
    cus_name varchar(50));
    
INSERT INTO ANS_orders VALUES
(1,'Keyboard','22','John'),
(2, 'Mouse', '13','Tom'),
(3, 'Monitor','23','Jenny'),
(4, 'Mousepad', '17','Peter'),
(5, 'Printer', '16','Ritha'),
(6, 'Mouse', '26','Nithu');

UPDATE ANS_orders SET cus_id=20 WHERE order_id=3;

DELETE FROM ANS_orders WHERE ORDER_ID=1;

TRUNCATE TABLE ANS_orders;

DROP TABLE ANS_orders ;


SELECT * from ans_orders;


CREATE TABLE ANS_HEALTH_RECORD
(
YEAR INT,
State VARCHAR(300),
HAI VARCHAR(300),
OPERATIVE_PROCEDURE VARCHAR(300),
FACILITY_ID INT,
FACILITY_NAME VARCHAR(300),
HOSPITAL_CATEGORY_RISK VARCHAR(300),
HOSPITAL_TYPE VARCHAR(300),
COUNTRY VARCHAR(300),
PROCEDURE_COUNT INT,
INFECTION_COUNT INT,
PREDICTED_INFECTION_COUNT FLOAT,
SIR FLOAT,
SIR_CI_95_LOWER_LIMIT FLOAT,
SIR_CI_95_UPPER_LIMIT FLOAT,
COMPARISION VARCHAR(300),
SIR_2015 FLOAT,
ONTRACK_TOWARD_2022_GOAL VARCHAR(300),
NOTES VARCHAR(300)
);

SELECT * FROM ANS_HEALTH_RECORD 

